syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "common/source.proto";
import "service_line_item.proto";

option go_package = "api/grpc/v1/invoice;invoice_grpc_service";

message NewInvoiceRequest {
  string tenant = 1;
  string loggedInUserId = 2;
  string contractId = 3;
  google.protobuf.Timestamp date = 4;
  bool dryRun = 5;
  repeated DryRunServiceLineItem dryRunServiceLineItems = 6;
  google.protobuf.Timestamp createdAt = 7;
  SourceFields sourceFields = 8;
}
message DryRunServiceLineItem {
  string serviceLineItemId = 1;
  string name = 3;
  BilledType billed = 4;
  double price = 5;
  int64 quantity = 6;
}

message FillInvoiceRequest {
  string tenant = 1;
  string loggedInUserId = 2;
  string invoiceId = 3;
  double amount = 4;
  double vat = 5;
  double total = 6;
  repeated InvoiceLine lines = 7;
  google.protobuf.Timestamp updatedAt = 8;
  SourceFields sourceFields = 9;
}

message InvoiceLine {
  string name = 2;
  double price = 3;
  int64 quantity = 4;
  double amount = 5;
  double vat = 6;
  double total = 7;
}

message PayInvoiceRequest {
  string tenant = 1;
  string loggedInUserId = 2;
  string invoiceId = 3;
  google.protobuf.Timestamp updatedAt = 4;
  SourceFields sourceFields = 5;
}

message PdfGeneratedInvoiceRequest {
  string tenant = 1;
  string loggedInUserId = 2;
  string invoiceId = 3;
  string repositoryFileId = 4;
  google.protobuf.Timestamp updatedAt = 5;
  string appSource = 6;
}

message InvoiceIdResponse {
  string id = 1;
}

service InvoiceGrpcService {
  rpc NewInvoice(NewInvoiceRequest) returns (InvoiceIdResponse);
  rpc FillInvoice(FillInvoiceRequest) returns (InvoiceIdResponse);
  rpc PdfGeneratedInvoice(PdfGeneratedInvoiceRequest) returns (InvoiceIdResponse);
  rpc PayInvoice(PayInvoiceRequest) returns (InvoiceIdResponse);
  rpc SimulateInvoice(NewInvoiceRequest) returns (InvoiceIdResponse);
}